# react框架脚手架

##简介

react脚手架是用于生成基于react框架为基础的组件，用户基于该组件脚手架可以方便地提取业务上的组件，专注业务组件的代码本身。基于该脚手架创建的组件可以在组件平台上被解析，并在用户查询时展示对应的demo说明文档和引用的资料。

## 业务组件库npm模板工程,各个业务系统如果要对自己的组件进行npm开发和管理,可以使用该样板工程，其指令及含义如下：
1. npm run dev启动开发环境,默认5000端口，渲染的入口为public/index.html，该指令用于组件代码本身的调试。
2. npm run build将src下的组件源码压缩，生成dist下的压缩文件，在一个项目多个组件的情况下按照组件名为文件夹进行区分，相应的组件代码压缩放在队应的组件名为名字的文件夹下。
3. npm run test运行spec文件下的所有测试用例。
4. npm run test-cov跑测试用例并生成4个覆盖率同时生成coverage文件夹，访问coverage文件夹下的lcov-report/index.html可以看到各个组件测试用例的覆盖率详情。
5. npm run test-dev时刻监测测试用例的变化并运行修改后的测试用例
6. npm run rundemo在组件源码编写完成后，用户需要在demo下创建以组件名为名字的文件夹并在队应的文件夹下编写组件的运行示例和组件的使用文档。具体格式参照脚手架中demo/MyComponent/index.html,在该文件的组件简介下以MD的格式编写组件使用文档，在index.js和index.css下编写组件队应的示例代码，完成后运行npm run rundemo进行编译压缩合并等工作，完成后会在组件名为文件名的文件夹下生成bundle.js和bundle.css,此时通过访问文件夹下的index.html的路径可以在浏览器中看到组件的示例效果。
7. npm run babel将src下的代码编译后放到lib下，同时css或者less文件也会复制到lib文件夹下，如果用户最后用npm的形式引用组件他实际引用的就是lib下的组件资源,src/以组件名命名的文件夹/ 下面的index.js和index.css是该组件的js和css入口，不能改为其它名字。
8. npm run pub将指定文件上传到公司npm私有库。注意如果是第一次执行npm publish在此之前npm要添加账号
```
$npm adduser
//Username: 花名拼音
//Password: 公用密码
//Email: 工作邮箱
```

## 使用步骤

1. 在MFP[http://mfp.meili-inc.com/](http://mfp.meili-inc.com/) 上注册生成项目，git clone 项目git地址到本地进行开发，npm install安装依赖项后npm run dev就可以运行在浏览器中访问localhost:5000了。
2. 在src目录下新建以组件名命名的文件夹，并在该文件夹下新建index.js和index.css添加组件的源代码。
3. 在spec/index.spec.js下添加测试用例，注意在spec文件下创建的测试用例要以*.spec.js的格式命名。
4. 在demo文件夹下新建以组件名命名的文件夹，并在该文件夹下新建MyComponent.html、index.js和index.css,MyComponent.html可以参考脚手架中的demo/MyComponent/MyComponent.html，组件的说明文档以MD的规范写在index.html的##组件简介下，组件的运行示例写在index.js和index.css中，完成编写后运行npm run rundemo,对源码进行合并压缩。注意要求index.html是只依赖压缩后的bundle.js和bundle.css就能独立运行的文件。
5. 开发完成后,手动修改package.json中的版本号,添加keyword，格式为keyword:"react,MyComponent",关键字要求至少3个要求包括组件使用技术，组件所属业务线，组件功能等以','隔开，若一个项目下包含多个组件则需要将所有组件名添加到keyword中，作为用户在组件平台搜索组件的查询关键字。
6. 最后执行: `npm run pub` 完成发布到美丽说集团私有cnpm包库的目的。

## 目录结构规范

```
  react-framework
    |-- demo
    |    |-- MyComponent                        以MyComponent名字命名的业务组件的运行示例demo
    |        |-- MyComponent.html               组件运行示例和组件说明文档
    |        |-- index.js                       组件运行示例的js源码
    |        |-- index.css                      组件运行示例的css源码
    |    |-- MyComponent2                       以MyComponent2名字命名的业务组件的运行示例demo
    |-- public                                  
    |    |-- index.html                         用于调试组件功能的html页面，可以通过localhost:5000访问
    |    |-- main.js                            用于调试组件功能的js代码
    |    |-- route.js                           用于一个项目多个组件时方便地添加页面和路由
    |-- scripts                                 脚本目录
    |    |-- publish.sh                         发布脚本,可根据需要自行调整
    |    |-- server.js                          本地起port为5000的服务，可以根据需要自行修改
    |-- spec
    |    |-- index.spec.js                      MyComponent组件的测试用例
    |    |-- setup.js                           
    |-- src                                     源码目录
    |    |-- MyComponent                        以MyComponent名字命名的组件
    |        |-- index.js                       MyComponent业务组件的源码
    |        |-- index.less                     MyComponent业务组件的样式源码
    |    |-- MyComponent2                       以MyComponent2名字命名的组件
    |-- .gitignore
    |-- .npmignore
    |-- package.json
    |-- README.md                               项目整体的说明比如项目背景，项目的CHANGELOG等
    |-- webpack.config.js                       组件打包webpack基础配置文件
    |-- webpack.dev.config.js                   组件跑server时的webpack配置文件
    |-- webpack.test.config.js                  组件打包运行示例的webpack配置文件
    
```

备注:

1.项目中默认的JavaScript测试框架为Mocha，默认的断言库为chai，用户也可以根据自己喜好和习惯自主选择不同的断言。
   